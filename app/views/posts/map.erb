<header class="posts" id="page-top">

<h1>Haggle Near You</h1>

    <div id="map"></div>

<script>
var map;
function initMap() {
  map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: 43.700, lng: -79.400},
    zoom: 8
  });


var post = <%= @post.to_json %>

var mapOptions = {
center: new google.maps.LatLng(43.700, -79.400),
zoom: 5,
mapTypeId: google.maps.MapTypeId.ROADMAP
//  marker:true
};
var infoWindow = new google.maps.InfoWindow();

for (i = 0; i < post.length; i++) {
var data = post[i]
var myLatlng = new google.maps.LatLng(data.latitude, data.longitude);
var marker = new google.maps.Marker({
position: myLatlng,
map: map,
title: data.title
});
(function(marker, data) {

// Attaching a click event to the current marker
google.maps.event.addListener(marker, "click", function(e) {
infoWindow.setContent(data.description);
infoWindow.open(map, marker);
});
})(marker, data);
}


}


</script>

        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCu0KSRgrBizub3FSRecbFnCvPzG4HVfcQ&callback=initMap"
        async defer></script>

    </header> 
